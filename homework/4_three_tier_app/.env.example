# Environment Configuration Template
# Copy this file to .env and fill in the values
# This file is generated by vault/scripts/init-vault.sh

# ============================================
# Vault Configuration
# ============================================
# Vault server address (use shared_vault_server hostname in Docker network)
VAULT_ADDR=https://shared_vault_server:8200

# Backend AppRole credentials for Flask application
# These are generated during Vault initialization
VAULT_ROLE_ID=your-role-id-here
VAULT_SECRET_ID=your-secret-id-here

# Apache AppRole credentials for certificate management
# These are generated separately for Apache frontend
APACHE_VAULT_ROLE_ID=your-apache-role-id-here
APACHE_VAULT_SECRET_ID=your-apache-secret-id-here
APACHE_VAULT_AUTH_PATH=approle-apache

# ============================================
# PKI Configuration for Apache
# ============================================
# PKI engine path in Vault
PKI_ENGINE=pki_localhost

# PKI role name for certificate generation
PKI_ROLE=apache-server-localhost

# ============================================
# Application Configuration
# ============================================
# Flask environment (development or production)
FLASK_ENV=production

# Python output buffering (1=unbuffered, useful for Docker logs)
PYTHONUNBUFFERED=1

# ============================================
# MinIO Object Storage Configuration
# ============================================
# MinIO endpoint (internal Docker hostname)
# Note: MinIO credentials (access_key, secret_key) are stored in Vault
# at path: secret/mes_local_cloud/minio
MINIO_ENDPOINT=minio:9000

# MinIO ROOT credentials (ADMIN ONLY - NOT USED BY APPLICATION)
# These are used by MinIO service for administration
# The application uses a dedicated user with limited privileges
MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=minioadmin

# MinIO APPLICATION USER (generated by setup-vault-app.sh)
# These credentials are stored in Vault and used by Flask backend
# This user has ONLY read/write access to the user-files bucket
MINIO_APP_USER=app-storage
MINIO_APP_PASSWORD=<generated-by-vault-script>

# MinIO bucket name for user files
MINIO_BUCKET=user-files

# Use SSL for MinIO connections (false for development)
MINIO_USE_SSL=false

# SECURITY ARCHITECTURE:
# - Root user: Administration only (create users, policies, buckets)
# - App user (app-storage): Limited to user-files bucket operations
# - Flask backend retrieves app-storage credentials from Vault
# - Follows principle of least privilege

# ============================================
# Database Configuration (Optional Fallback)
# ============================================
# These are optional fallbacks if Vault is unavailable
# In production, these should be left unset and managed by Vault

# POSTGRES_USER=admin
# POSTGRES_DB=postgres_db

# ============================================
# SECURITY NOTES
# ============================================
# 1. Never commit this file to version control
# 2. Keep VAULT_SECRET_ID secure and rotate regularly
# 3. Use Vault for all secrets in production
# 4. Fallback environment variables are for emergencies only
# 5. Monitor .env file permissions (should be 600)

# ============================================
# How to Generate These Values
# ============================================
# Run the Vault initialization script:
#   cd vault/scripts
#   ./init-vault.sh
#
# This will:
# - Initialize and unseal Vault
# - Generate secure secrets
# - Create this .env file with proper values
# - Save unseal keys to vault-keys.json
